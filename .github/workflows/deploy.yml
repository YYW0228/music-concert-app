name: ğŸš€ è‡ªåŠ¨éƒ¨ç½²åˆ°GitHub Pages

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ“¥ æ£€å‡ºä»£ç 
      uses: actions/checkout@v3
      
    - name: ğŸ“¦ è®¾ç½®Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18'
        
    - name: ğŸ“‹ å®‰è£…ä¾èµ–
      run: npm install
      
    - name: ğŸ—ï¸ æ„å»ºé¡¹ç›®
      run: |
        npm run deploy:h5 || echo "H5æ„å»ºè·³è¿‡"
        
    - name: ğŸ“‚ å¤åˆ¶æ–‡ä»¶åˆ°æ ¹ç›®å½•
      run: |
        cp h5-dist/*.html . 2>/dev/null || true
        cp h5-dist/*.json . 2>/dev/null || true  
        cp h5-dist/*.js . 2>/dev/null || true
        cp -r h5-dist/static . 2>/dev/null || true
        
    - name: ğŸš€ éƒ¨ç½²åˆ°GitHub Pages
      uses: peaceiris/actions-gh-pages@v3
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: .
        exclude_assets: '.github,node_modules,scripts,deploy,pages,tmp_rovodev_*'
        
    - name: ğŸ“¢ éƒ¨ç½²é€šçŸ¥
      run: |
        echo "ğŸ‰ éƒ¨ç½²å®Œæˆï¼"
        echo "ğŸŒ è®¿é—®åœ°å€: https://yyw0228.github.io/music-concert-app"
